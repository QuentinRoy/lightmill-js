# Snapshot report for `src/__tests__/run-experiment.js`

The actual snapshot is saved in `run-experiment.js.snap`.

Generated by [AVA](https://ava.li).

## `runExperiment` calls `app.crash` then throws if a post goes wrong

> Snapshot 1

    [
      [
        'runTrial',
        [
          {
            block: {
              number: 0,
            },
            number: 0,
          },
        ],
      ],
      [
        '* runTrial',
        undefined,
      ],
      [
        'postResults',
        [
          undefined,
        ],
      ],
      [
        'runTrial',
        [
          {
            block: {
              number: 0,
            },
            number: 1,
          },
        ],
      ],
      [
        '* runTrial',
        undefined,
      ],
      [
        'postResults',
        [
          undefined,
        ],
      ],
      [
        'runTrial',
        [
          {
            block: {
              number: 1,
            },
            number: 0,
          },
        ],
      ],
      [
        '* postResults',
        undefined,
      ],
      [
        'X postResults',
        Error {
          message: 'reject test',
        },
      ],
      [
        'crash',
        [
          'Could not post trial results: reject test',
          Error {
            original: Error {
              message: 'reject test',
            },
            message: 'Could not post trial results: reject test',
          },
          {
            id: 'runId',
          },
        ],
      ],
    ]

## `runExperiment` calls `app.crash` then throws if a post goes wrong even if all trials are done

> Snapshot 1

    [
      [
        'runTrial',
        [
          {
            block: {
              number: 0,
            },
            number: 0,
          },
        ],
      ],
      [
        '* runTrial',
        {
          res: 0,
        },
      ],
      [
        'postResults',
        [
          {
            res: 0,
          },
        ],
      ],
      [
        'runTrial',
        [
          {
            block: {
              number: 1,
            },
            number: 0,
          },
        ],
      ],
      [
        '* runTrial',
        {
          res: 1,
        },
      ],
      [
        'postResults',
        [
          {
            res: 1,
          },
        ],
      ],
      [
        '* postResults',
        undefined,
      ],
      [
        'X postResults',
        Error {
          message: 'reject test',
        },
      ],
      [
        'crash',
        [
          'Could not post trial results: reject test',
          Error {
            original: Error {
              message: 'reject test',
            },
            message: 'Could not post trial results: reject test',
          },
          {
            id: 'runId',
          },
        ],
      ],
    ]

## `runExperiment` calls `app.crash` then throws if a trial goes wrong

> Snapshot 1

    [
      [
        'runTrial',
        [
          {
            block: {
              number: 0,
            },
            number: 0,
          },
        ],
      ],
      [
        '* runTrial',
        {
          res: 1,
        },
      ],
      [
        'runTrial',
        [
          {
            block: {
              number: 0,
            },
            number: 1,
          },
        ],
      ],
      [
        '* runTrial',
        {
          res: 2,
        },
      ],
      [
        'runTrial',
        [
          {
            block: {
              number: 1,
            },
            number: 0,
          },
        ],
      ],
      [
        'X runTrial',
        Error {
          message: 'bad trial',
        },
      ],
      [
        'crash',
        [
          'bad trial',
          Error {
            message: 'bad trial',
          },
          {
            id: 'runId',
          },
        ],
      ],
    ]

## `runExperiment` runs as expected if every app handlers are provided

> Snapshot 1

    [
      [
        'app.start',
        [],
      ],
      [
        'connection.getRun',
        [],
      ],
      [
        '* connection.getRun',
        {
          id: 'runId',
        },
      ],
      [
        'storage.set',
        [
          'runId',
        ],
      ],
      [
        'connection.getCurrentTrial',
        [],
      ],
      [
        '* connection.getCurrentTrial',
        {
          block: {
            number: 0,
          },
          number: 0,
        },
      ],
      [
        'app.initBlock',
        [
          {
            number: 0,
          },
        ],
      ],
      [
        '* app.initBlock',
        undefined,
      ],
      [
        'connection.flush',
        [
          1,
        ],
      ],
      [
        '* connection.flush',
        undefined,
      ],
      [
        'app.runTrial',
        [
          {
            block: {
              number: 0,
            },
            number: 0,
          },
        ],
      ],
      [
        '* app.runTrial',
        {
          result: '0-0',
        },
      ],
      [
        'connection.postResults',
        [
          {
            result: '0-0',
          },
        ],
      ],
      [
        'connection.endTrial',
        [],
      ],
      [
        '* connection.endTrial',
        {
          block: {
            number: 0,
          },
          number: 1,
        },
      ],
      [
        'connection.flush',
        [
          1,
        ],
      ],
      [
        '* connection.flush',
        undefined,
      ],
      [
        'app.runTrial',
        [
          {
            block: {
              number: 0,
            },
            number: 1,
          },
        ],
      ],
      [
        '* app.runTrial',
        {
          result: '0-1',
        },
      ],
      [
        'connection.postResults',
        [
          {
            result: '0-1',
          },
        ],
      ],
      [
        'connection.endTrial',
        [],
      ],
      [
        '* connection.endTrial',
        {
          block: {
            number: 1,
          },
          number: 0,
        },
      ],
      [
        'app.initBlock',
        [
          {
            number: 1,
          },
        ],
      ],
      [
        '* app.initBlock',
        undefined,
      ],
      [
        'connection.flush',
        [
          1,
        ],
      ],
      [
        '* connection.flush',
        undefined,
      ],
      [
        'app.runTrial',
        [
          {
            block: {
              number: 1,
            },
            number: 0,
          },
        ],
      ],
      [
        '* app.runTrial',
        {
          result: '1-0',
        },
      ],
      [
        'connection.postResults',
        [
          {
            result: '1-0',
          },
        ],
      ],
      [
        'connection.endTrial',
        [],
      ],
      [
        '* connection.endTrial',
        {
          block: {
            number: 1,
          },
          number: 1,
        },
      ],
      [
        'connection.flush',
        [
          1,
        ],
      ],
      [
        '* connection.flush',
        undefined,
      ],
      [
        'app.runTrial',
        [
          {
            block: {
              number: 1,
            },
            number: 1,
          },
        ],
      ],
      [
        '* app.runTrial',
        {
          result: '1-1',
        },
      ],
      [
        'connection.postResults',
        [
          {
            result: '1-1',
          },
        ],
      ],
      [
        'connection.endTrial',
        [],
      ],
      [
        '* connection.endTrial',
        undefined,
      ],
      [
        'connection.flush',
        [],
      ],
      [
        '* connection.flush',
        undefined,
      ],
      [
        'storage.remove',
        [],
      ],
      [
        'connection.disconnect',
        [],
      ],
      [
        '* connection.disconnect',
        undefined,
      ],
      [
        'app.end',
        [],
      ],
    ]

## `runExperiment` works properly even if only `app.runTrial` is provided

> Snapshot 1

    [
      [
        'connection.getRun',
        [],
      ],
      [
        '* connection.getRun',
        {
          id: 'runId',
        },
      ],
      [
        'storage.set',
        [
          'runId',
        ],
      ],
      [
        'connection.getCurrentTrial',
        [],
      ],
      [
        '* connection.getCurrentTrial',
        {
          block: {
            number: 0,
          },
          number: 0,
        },
      ],
      [
        'connection.flush',
        [
          1,
        ],
      ],
      [
        '* connection.flush',
        undefined,
      ],
      [
        'app.runTrial',
        [
          {
            block: {
              number: 0,
            },
            number: 0,
          },
        ],
      ],
      [
        '* app.runTrial',
        {
          result: '0-0',
        },
      ],
      [
        'connection.postResults',
        [
          {
            result: '0-0',
          },
        ],
      ],
      [
        'connection.endTrial',
        [],
      ],
      [
        '* connection.endTrial',
        {
          block: {
            number: 0,
          },
          number: 1,
        },
      ],
      [
        'connection.flush',
        [
          1,
        ],
      ],
      [
        '* connection.flush',
        undefined,
      ],
      [
        'app.runTrial',
        [
          {
            block: {
              number: 0,
            },
            number: 1,
          },
        ],
      ],
      [
        '* app.runTrial',
        {
          result: '0-1',
        },
      ],
      [
        'connection.postResults',
        [
          {
            result: '0-1',
          },
        ],
      ],
      [
        'connection.endTrial',
        [],
      ],
      [
        '* connection.endTrial',
        {
          block: {
            number: 1,
          },
          number: 0,
        },
      ],
      [
        'connection.flush',
        [
          1,
        ],
      ],
      [
        '* connection.flush',
        undefined,
      ],
      [
        'app.runTrial',
        [
          {
            block: {
              number: 1,
            },
            number: 0,
          },
        ],
      ],
      [
        '* app.runTrial',
        {
          result: '1-0',
        },
      ],
      [
        'connection.postResults',
        [
          {
            result: '1-0',
          },
        ],
      ],
      [
        'connection.endTrial',
        [],
      ],
      [
        '* connection.endTrial',
        {
          block: {
            number: 1,
          },
          number: 1,
        },
      ],
      [
        'connection.flush',
        [
          1,
        ],
      ],
      [
        '* connection.flush',
        undefined,
      ],
      [
        'app.runTrial',
        [
          {
            block: {
              number: 1,
            },
            number: 1,
          },
        ],
      ],
      [
        '* app.runTrial',
        {
          result: '1-1',
        },
      ],
      [
        'connection.postResults',
        [
          {
            result: '1-1',
          },
        ],
      ],
      [
        'connection.endTrial',
        [],
      ],
      [
        '* connection.endTrial',
        undefined,
      ],
      [
        'connection.flush',
        [],
      ],
      [
        '* connection.flush',
        undefined,
      ],
      [
        'storage.remove',
        [],
      ],
      [
        'connection.disconnect',
        [],
      ],
      [
        '* connection.disconnect',
        undefined,
      ],
    ]
